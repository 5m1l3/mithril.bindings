<html>
<head>
	<title></title>
	<script src="mithril.js"></script>
	<script src="../mithril.bindings.js"></script>
	<style>
		.allBoxes { font-weight: bold }
	</style>
</head>
<body>

<div id="content"></div>

<script>
var app = {
	model: function() {
		var self = this;
		self.boxes = [m.p(), m.p(), m.p()];
		//	Using a delayed property
		self.allBoxesObj = m.p().delay(true);
		//	The "all boxes" checkbox
		self.allBoxes = function() {
			var i, isChecked = true;
			for(i = 0; i < self.boxes.length; i += 1) {
				if(! self.boxes[i]()) {
					isChecked = false;
					break;
				}
			}
			self.allBoxesObj(isChecked);
			return isChecked;
		};
		//	Set all checkboxes to checked
		self.clickAll = function(){
			var isChecked = self.allBoxesObj(!self.allBoxesObj()), i;
			for(i = 0; i < self.boxes.length; i += 1) {
				self.boxes[i](isChecked);
			}
		};
	},
	view: function(c) {
		return [
			m.e("div", [
				m.e("div", [
					m.e("input", { type: "checkbox", value: "all", id: "allBoxes", onclick: c.model.clickAll, checked: c.model.allBoxes }),
					m.e("label", { "for": "allBoxes", class: "allBoxes"}, "All boxes" )
				]),
				m.e("div", [
					m.e("input", { type: "checkbox", value: "1", id: "box_1", checked: c.model.boxes[0]}),
					m.e("label", { "for": "box_1"}, "Box one" )
				]),
				m.e("div", [
					m.e("input", { type: "checkbox", value: "2", id: "box_2", checked: c.model.boxes[1]}),
					m.e("label", { "for": "box_2"}, "Box two" )
				]),
				m.e("div", [
					m.e("input", { type: "checkbox", value: "3", id: "box_3", checked: c.model.boxes[2]}),
					m.e("label", { "for": "box_3"}, "Box three" )
				])
			])
		];
	},
	controller: function() {
		var self = this;
		window.model = self.model = new app.model();
	}
};

m.module(document.getElementById('content'), app);

</script>
</body>
</html>